<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sign in · AI Photo Studio</title>
  <meta name="theme-color" content="#4f46e5" />

  <!-- Icons -->
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" href="/apple-touch-icon.png">

  <style>
    :root {
      --grad: linear-gradient(90deg,#6366f1,#8b5cf6);
      --card: rgba(13,20,42,0.75);
      --border: rgba(148,163,184,.25);
    }
    body {
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
      background:#050816;
      color:#e5e7eb;
      display:flex;
      justify-content:center;
      align-items:center;
      min-height:100vh;
      background:
        radial-gradient(1000px 700px at 0% 0%, #1d2340 0%, transparent 60%),
        radial-gradient(1000px 700px at 100% 0%, #141b34 0%, transparent 60%),
        radial-gradient(1000px 700px at 50% 120%, #0a1226 0%, transparent 60%);
    }
    .card {
      width:100%;
      max-width:420px;
      background:var(--card);
      border:1px solid var(--border);
      border-radius:16px;
      padding:24px;
      box-shadow:0 8px 30px rgba(0,0,0,.35);
    }
    h1 {
      font-size:22px;
      font-weight:800;
      margin:0 0 16px;
      text-align:center;
    }
    .row { display:grid; gap:10px; margin:16px 0; }
    .btn {
      height:46px;
      border-radius:12px;
      border:1px solid var(--border);
      background:#0b1227;
      color:#fff;
      font-weight:600;
      cursor:pointer;
      display:flex;
      align-items:center;
      justify-content:center;
      gap:8px;
    }
    .btn.primary { background:var(--grad); border:none; color:#fff; }
    .input {
      height:44px;
      border-radius:12px;
      border:1px solid var(--border);
      background:#0b1227;
      color:#fff;
      padding:0 12px;
      width:100%;
    }
    .label { font-size:12px; color:#a5b4fc; margin-bottom:4px; }
    .error { color:#fecaca; font-size:13px; margin-top:4px; display:none; }
    .spacer {
      text-align:center;
      font-size:12px;
      color:#94a3b8;
      margin:12px 0;
      position:relative;
    }
    .spacer::before, .spacer::after {
      content:""; height:1px; background:var(--border);
      position:absolute; top:50%; width:40%;
    }
    .spacer::before { left:0; } .spacer::after { right:0; }
  </style>
</head>
<body>
  <div class="card">
    <h1>Sign in to AI Photo Studio</h1>

    <!-- Google -->
    <button id="btnGoogle" class="btn">
      <svg width="18" height="18" viewBox="0 0 48 48" fill="none">
        <path fill="#FFC107" d="M43.611 20.083H42V20H24v8h11.303C33.676 31.91 29.223 35 24 35c-7.18 0-13-5.82-13-13S16.82 9 24 9c3.313 0 6.313 1.253 8.59 3.31l5.657-5.657C35.577 3.042 29.987 1 24 1 10.745 1 0 11.745 0 25s10.745 24 24 24 24-10.745 24-24c0-1.627-.167-3.216-.389-4.917z"/>
        <path fill="#FF3D00" d="M6.306 14.691L12.97 19.6C14.826 15.154 19.06 12 24 12c3.313 0 6.313 1.253 8.59 3.31l5.657-5.657C35.577 3.042 29.987 1 24 1 15.317 1 7.86 5.773 4.003 12.691z"/>
        <path fill="#4CAF50" d="M24 49c5.162 0 9.868-1.977 13.43-5.197l-6.197-5.236C29.012 39.542 26.64 40.5 24 40.5c-5.176 0-9.582-3.497-11.164-8.204l-6.47 4.986C9.224 44.775 16.067 49 24 49z"/>
        <path fill="#1976D2" d="M43.611 20.083H42V20H24v8h11.303c-1.411 3.316-4.679 5.917-8.303 5.917-2.64 0-5.012-.958-6.827-2.434l-6.47 4.985C16.067 44.775 22.91 49 30 49c11.598 0 19.5-7.902 19.5-19.5 0-1.627-.167-3.216-.389-4.917z"/>
      </svg>
      Continue with Google
    </button>

    <div class="spacer">or</div>

    <!-- Email -->
    <div class="row">
      <div>
        <div class="label">Email</div>
        <input id="email" class="input" type="email" placeholder="you@example.com">
      </div>
      <div>
        <div class="label">Password</div>
        <input id="password" class="input" type="password" placeholder="••••••••">
      </div>
      <button id="btnEmailSignIn" class="btn">Sign in with Email</button>
      <button id="btnEmailSignUp" class="btn">Create Account</button>
      <div id="emailError" class="error"></div>
    </div>

    <div class="spacer">or</div>

    <!-- Phone -->
    <div class="row">
      <div>
        <div class="label">Phone</div>
        <input id="phone" class="input" type="tel" placeholder="+44 7123 456789">
      </div>
      <div id="recaptcha-container"></div>
      <button id="btnSendCode" class="btn">Send Code</button>
      <div id="codeRow" style="display:none">
        <div class="label">Verification Code</div>
        <input id="code" class="input" type="text" placeholder="6-digit code">
        <button id="btnVerifyCode" class="btn primary" style="margin-top:8px">Verify & Sign in</button>
      </div>
      <div id="phoneError" class="error"></div>
    </div>

    <div class="spacer">or</div>

    <!-- Guest -->
    <button id="btnGuest" class="btn">Continue as Guest (limited)</button>

    <p style="font-size:12px; color:#9ca3af; margin-top:12px; text-align:center">
      By continuing, you agree to the Terms and Privacy Policy.
    </p>
  </div>

  <!-- Firebase (Compat) -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyBaIs-6MmFGhCSY-VGvAQLLn4H6_lYjwRA",
      authDomain: "aiphotostudioapp.firebaseapp.com",
      projectId: "aiphotostudioapp",
      storageBucket: "aiphotostudioapp.appspot.com",
      messagingSenderId: "1056724519182",
      appId: "1:1056724519182:web:4b753ddbca1dc50c31ef5f",
      measurementId: "G-0QWJGBLXVW"
    };
    if (!firebase.apps.length) {
      firebase.initializeApp(firebaseConfig);
    }
    const auth = firebase.auth();

    // Already signed in → redirect
    auth.onAuthStateChanged(user => { if (user) location.replace('/'); });

    const $ = id => document.getElementById(id);

    // Google (redirect works on iOS)
    $('btnGoogle').onclick = async () => {
      const provider = new firebase.auth.GoogleAuthProvider();
      try {
        await auth.signInWithRedirect(provider);
      } catch (e) { alert(e.message); }
    };

    // Email
    $('btnEmailSignIn').onclick = async () => {
      try {
        await auth.signInWithEmailAndPassword($('email').value, $('password').value);
      } catch (e) { $('emailError').textContent = e.message; $('emailError').style.display='block'; }
    };
    $('btnEmailSignUp').onclick = async () => {
      try {
        const cred = await auth.createUserWithEmailAndPassword($('email').value, $('password').value);
        try { await cred.user.sendEmailVerification(); } catch {}
      } catch (e) { $('emailError').textContent = e.message; $('emailError').style.display='block'; }
    };

    // Phone
    let confirmationResult = null;
    const recaptcha = new firebase.auth.RecaptchaVerifier('recaptcha-container', { size:'normal' });
    recaptcha.render();

    $('btnSendCode').onclick = async () => {
      try {
        confirmationResult = await auth.signInWithPhoneNumber($('phone').value, recaptcha);
        $('codeRow').style.display = 'block';
      } catch (e) { $('phoneError').textContent = e.message; $('phoneError').style.display='block'; }
    };
    $('btnVerifyCode').onclick = async () => {
      try {
        await confirmationResult.confirm($('code').value);
      } catch (e) { $('phoneError').textContent = e.message; $('phoneError').style.display='block'; }
    };

    // Guest
    $('btnGuest').onclick = () => auth.signInAnonymously();
  </script>
</body>
</html>
