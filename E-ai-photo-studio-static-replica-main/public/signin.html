<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Sign In · AI Photo Studio</title>
  <meta name="theme-color" content="#4f46e5"/>

  <style>
    body { 
      margin:0; padding:0; 
      font-family:system-ui; 
      background:#f3f4f6; 
      display:flex; justify-content:center; align-items:center; 
      height:100vh; 
    }
    .card {
      width:100%; max-width:380px;
      background:white; padding:28px; border-radius:16px;
      box-shadow:0 4px 20px rgba(0,0,0,.08);
    }
    h1 { margin:0 0 10px; font-size:26px; font-weight:800; text-align:center; }
    p { margin:0 0 22px; text-align:center; color:#6b7280; }

    input {
      width:100%; padding:12px 14px; margin:8px 0 14px;
      border-radius:10px; border:1px solid #d1d5db; font-size:15px;
    }

    button {
      width:100%; padding:12px; border:0; border-radius:10px;
      font-weight:700; cursor:pointer; font-size:15px; margin-top:6px;
    }
    .primary { background:#4f46e5; color:white; }
    .google  { background:white; border:1px solid #d1d5db; }
    .muted   { margin-top:12px; font-size:14px; text-align:center; color:#ef4444; }
    a { color:#4f46e5; text-decoration:none; }
  </style>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDsBDuaZ_rl7ro63Fv5gPh37EwSkfh-NqM",
      authDomain: "aiphotostudioapp.firebaseapp.com",
      projectId: "aiphotostudioapp",
      storageBucket: "aiphotostudioapp.appspot.com",
      messagingSenderId: "1056724519182",
      appId: "1:1056724519182:web:93410e1b71a292e531ef5f",
      measurementId: "G-YMB9JJHNBE"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
  </script>
</head>

<body>
  <div class="card">
    <h1>Welcome Back</h1>
    <p>Sign in to continue</p>

    <div id="err" class="muted"></div>

    <input id="email" type="email" placeholder="Email"/>
    <input id="pass"  type="password" placeholder="Password"/>

    <button id="btnEmail" class="primary">Continue with Email</button>
    <button id="btnGoogle" class="google">Continue with Google</button>

    <p style="margin-top:18px;font-size:14px;">
      Don’t have an account? <a href="/signup.html">Sign Up</a>
    </p>
  </div>

  <script>
    const errEl     = document.getElementById("err");
    const emailEl   = document.getElementById("email");
    const passEl    = document.getElementById("pass");
    const btnEmail  = document.getElementById("btnEmail");
    const btnGoogle = document.getElementById("btnGoogle");

    // ----------------------
    // EMAIL SIGN-IN
    // ----------------------
    btnEmail.addEventListener("click", async () => {
      errEl.textContent = "";
      btnEmail.disabled = true;
      btnEmail.textContent = "Checking…";

      const email = emailEl.value.trim();
      const pass  = passEl.value.trim();
      if (!email || !pass) {
        errEl.textContent = "Enter email and password.";
        btnEmail.disabled = false;
        btnEmail.textContent = "Continue with Email";
        return;
      }

      try {
        await auth.signInWithEmailAndPassword(email, pass);

        // ✅ REDIRECT TO MAIN APP
        window.location.href = "/index.html";

      } catch (err) {
        errEl.textContent = err.message.replace("Firebase:", "").trim();
      } finally {
        btnEmail.disabled = false;
        btnEmail.textContent = "Continue with Email";
      }
    });

    // ----------------------
    // GOOGLE SIGN-IN
    // ----------------------
    btnGoogle.addEventListener("click", async () => {
      errEl.textContent = "";
      btnGoogle.disabled = true;
      btnGoogle.textContent = "Connecting…";

      try {
        const provider = new firebase.auth.GoogleAuthProvider();
        await auth.signInWithPopup(provider);

        // ✅ REDIRECT TO MAIN APP
        window.location.href = "/index.html";

      } catch (err) {
        errEl.textContent = err.message.replace("Firebase:", "").trim();
      } finally {
        btnGoogle.disabled = false;
        btnGoogle.textContent = "Continue with Google";
      }
    });
  </script>
</body>
</html>
